---
title:  "Linode или DigitalOcean, муки выбора"
date:   2014-03-10 04:13:00
tags:   ["hosting", "vps"]
layout: "post"

---

Пришло СМС уведомление из банка о списании семисот российских рублей в пользу VPS хостера [Linode][li-ref]. Мне наконец начало казаться, что это многовато для хостинга домашней странички и периодического запуска каких-нибудь экспериментов.

Ведясь на годный пиар и вкусные тарифы [DigitalOcean][do-ref] я не выдержал и решил таки переехать к ним. Но нельзя просто взять и переехать. Пришлось покрасноглазить ночку и посравнивать производительность. Итак, тесты гонялись с помощью утилиты `sysbench` на похожих тарифах в идентичных окружениях: Debian 7 Wheezy x64 с ядром Linux 3.2.0. Виртуалки абсолютно чистые, ничем другим не занятые.

<!-- cut -->

## CPU

Сравнение, конечно, не совсем честное, ибо характеристики процессора у виртуалок разные. У DO это одно ядро с частотой 2 GHz и кэшем 4096 KB, в то время как у Linode восемь ядер по 2.6 GHz и 20480 KB кэша.

|                | DigitalOcean | Linode (1 thread) | Linode (8 threads) |
| -------------- | ------------ | ----------------- | ------------------ |
| 10 000 events  | 14.4543s     | 28.2139s          | 5.9061s            |
| 100 000 events | 148.2620s    | 390.0250s         | 54.3713s           |

Несмотря на разницу в характеристиках, один поток у DO отрабатывает в два раза быстрее потока у Linode. Но если задействовать все 8 ядер, то DO оказывается медленнее.

У дополнительных ядер Linode есть [определенные ограничения](https://www.linode.com/faq.cfm#how-do-i-get-my-fair-share-of-cpu) на использование. Если коротко: одно ядро здесь полностью ваше, остальные хостер разрешает использовать только в случае, если их реальные хозяева ничем не заняты. Чем выше тариф, тем больше ядер вам доступно для гарантированного использования, но даже на самом дешевом тарифе у Linode вы получаете возможность гонять задачи в 8 потоков.

Реальная разница в производительности процессора в момент теста была практически в 3 раза. 1:0 в пользу Linode.

## Память

Тест на скорость чтения/записи данных в оперативную память. На дефолтных настройках sysbench пытается провести чтение и запись 102400 MB данных, здесь менять ничего не будем.

|                | DigitalOcean | Linode    |
| -------------- | ------------ | --------- |
| 102400 MB      | 85.6444s     | 253.7881s |


Разница тоже в 3 раза но на этот раз память оказалась быстрее у DO, так что 1:1.

## Диск

Скорость работы дисковой подсистемы. Пытаемся писать и читать файлы с рандомными данными, размером по 16 MB.

|                        | DigitalOcean | Linode     |
| ---------------------- | ------------ | ---------- |
| Чтение, 10 000 файлов  | 0.0247s      | 120.0389s  |
| Запись, 10 000 файлов  | 6.4895s      | 22.2742s   |
| Чтение, 100 000 файлов | 7.5546s      | 1044.7557s |
| Запись, 100 000 файлов | 87.8541s     | 247.5267s  |


Лидер очевиден. Благодаря SSD, с большим отрывом победил DigitalOcean, 1:2.

## Прочие плюшки

Linode списывает оплату с вашей карточки единовременно, первого числа каждого месяца. У DigitalOcean оплата почасовая, что мне лично нравится больше, такой подход позволяет в любой момент создать ноду и платить только за реальное время использования. У Linode же пришлось бы платить полную стоимость, даже если виртуалка нужна вам на пару дней для тестов, 1:3.

У каждого из хостеров действует ограничение на количество принятого и переданного трафика. Linode заблокирует обмен данными до вашего вмешательства, если вдруг объем трафика превысит лимит. DigitalOcean же начнет втихаря списывать с вашего счета $0.02 за каждый лишний гигабайт. Сказать, что лучше я затрудняюсь. Проектам, которым важно оставаться на связи несмотря ни на что подойдет второй вариант, а лично мне ближе политика Linode ибо я не хочу однажды вернуться из отпуска и обнаружить пустой счет из за того, что сервер попал под DDoS.

## Вердикт

Восьемь ядер — это хорошо. Если вы выбираете сервер для многопоточной числодробилки, ваш выбор — [Linode][li-ref]. Для себя же я выбрал [DigitalOcean][do-ref], как отличную площадку для приложений с большим числом операций ввода/вывода.

Помните, на дворе март 2014 года. Если вы читаете этот пост спустя долгое время, характеристики тарифов, а соответственно и цифры могут не хило так измениться.

[li-ref]: https://www.linode.com/?r=0dd1fb7290eb68246fb6d8617b44e21288b536af
[do-ref]: https://www.digitalocean.com/?refcode=6de1c7ceaf96
